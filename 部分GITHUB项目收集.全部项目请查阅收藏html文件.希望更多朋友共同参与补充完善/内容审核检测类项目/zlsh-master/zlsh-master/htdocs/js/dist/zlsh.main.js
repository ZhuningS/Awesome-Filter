/*! zlsh 2014-07-15 */
function islogin_layout(a){$("#islogin_cont").show(),$("#nologin_cont").hide(),$("#login_nickname").text(a)}function nologin_layout(){$("#islogin_cont").hide(),$("#nologin_cont").show()}txv.login.init({useStrictLogin:!0},!0),txv.login.addLoginCallback(function(){islogin_layout(txv.login.getNick()),window.location.reload()}),txv.login.addLogoutCallback(function(){nologin_layout()}),$(function(){txv.login.isLogin()?islogin_layout(txv.login.getNick()):txv.login.openLogin()}),$(".user-login").click(function(){txv.login.isLogin()?islogin_layout(txv.login.getNick()):txv.login.openLogin()}),$(".user-logout").click(function(){txv.login.logout()}),window.ZLSH=window.ZLSH||{},ZLSH.player=function(a){function b(b){a.extend(f,b),d()}function c(b,c){a("#"+f.vtitleContId).text(c+"("+b+")"),i(b)}function d(){a(document).on("click","[data-play]",function(){var b=a(this),d=b.attr("data-play"),e=b.attr("title");d&&c(d,e)}),window.__flashplayer_islastvideo=function(){return!0},window.__tenplay_getuinfo=function(){return txv.login.isLogin()?2:0},window.__flashplayer_openLogin=function(a){a=a||"",txv.login.openLogin({success:function(){}})}}var e="http://imgcache.gtimg.cn/tencentvideo_v1/tvp/js/tvp.player_v2_jq.js",f={width:560,height:450,modId:"modPopPlayer",vtitleContId:"myLargeModalLabel"},g=null,h=null,i=function(b){g?(h.clear(),h.setVid(b),g=new tvp.Player,g.create({width:f.width,height:f.height,video:h,vodFlashType:"TencentPlayer",vodFlashExtVars:{share:0,popup:0,light:0,searchbar:0},modId:f.modId,autoplay:!0})):a.getScript(e,function(){g=new tvp.Player,h=new tvp.VideoInfo,h.setVid(b),g.create({width:f.width,height:f.height,video:h,vodFlashType:"TencentPlayer",vodFlashExtVars:{share:0,popup:0,light:0,searchbar:0},modId:f.modId,autoplay:!0})})};return{init:b,play:c}}(jQuery),window.ZLSH=window.ZLSH||{},ZLSH.request=function(a){function b(b,d){b=b||c[0],d=d||{},this.cgi=b,this.param={otype:"json",offset:0,limit:10,audit_result:1},this.timeout=8e3,this.check=null,this.error=null,this.success=null,a.extend(this.param,d)}var c={0:"http://shenhe.video.qq.com/fcgi-bin/lock_video_list?",1:"http://shenhe.video.qq.com/fcgi-bin/audit_video_list?",2:"http://shenhe.video.qq.com/fcgi-bin/audit_video_list?"};return a.extend(b.prototype,{setParam:function(b){a.extend(this.param,b)},getParam:function(a){return this.param[a]},setFn:function(b,c){var d=this;a.isFunction(c)&&"string"==typeof b&&(d[b]=c)},buildUrl:function(){var b=[];b.push(this.cgi);var c=a.param(this.param);return b.push(c),b.join("")},query:function(b){var c=this,d=c.buildUrl();a.ajax({url:d,dataType:"jsonp",timeout:c.timeout,cache:!1,complete:function(){},error:function(a){c.error&&c.error(a)},success:function(d){var e=!0;a.isFunction(c.check)&&(e=c.check(d)),e?(c.success&&c.success(d),a.isFunction(b)&&b.call(c,d)):c.error&&c.error(d)}})}}),b.defaultInit=function(a,d){a=""+a,a=a||"0";var e=c[a],f=new b(e,d);return f},b}(jQuery),window.ZLSH=window.ZLSH||{},ZLSH.shenhe=function(a){function b(b){b&&a.isArray(b.videoArr)&&0!=b.videoArr.length&&(b.type=b.type||0,0==b.type?c(b):d(b))}function c(a){e(f,a)}function d(a){e(g,a)}function e(b,c){var d=c.videoArr;a.ajax({url:b+"?g_tk="+a.getToken(),data:{value:JSON.stringify(d),otype:"json"},type:"post",dataType:"jsonp",error:function(b){a.isFunction(c.error)&&c.error(b)},success:function(b){b&&0==b.returncode?a.isFunction(c.success)&&c.success(b):a.isFunction(c.error)&&c.error(b)}})}var f="http://shenhe.video.qq.com/fcgi-bin/audit_locked_video",g="http://shenhe.video.qq.com/fcgi-bin/reset_audited_video";return{shenhe:b}}(jQuery),window.ZLSH=window.ZLSH||{},ZLSH.util=function(a){function b(b){c||(c=a(".message-alert-dlg"));var d=c.find("#modMessageAlert");d.html(b),c.modal()}var c=null;return{message:b}}(jQuery),g_typemap={content:[{id:"1",target:"电影"},{id:"2",target:"电视剧"},{id:"3",target:"动漫"},{id:"4",target:"体育"},{id:"5",target:"娱乐"},{id:"6",target:"游戏"},{id:"7",target:"播客"},{id:"8",target:"热点"},{id:"9",target:"纪录片"},{id:"10",target:"综艺"},{id:"11",target:"春晚"},{id:"12",target:"两会"},{id:"13",target:"花儿朵朵"},{id:"99",target:"快女"},{id:"103",target:"原创"},{id:"15",target:"英超"},{id:"17",target:"意甲"},{id:"97",target:"亚运会"},{id:"0",target:"未知"},{id:"18",target:"世博"},{id:"19",target:"快男"},{id:"98",target:"高清体验专区"},{id:"21",target:"世界杯"},{id:"22",target:"MV"},{id:"23",target:"新闻"},{id:"24",target:"财经"},{id:"25",target:"时尚"},{id:"26",target:"旅游"},{id:"27",target:"教育"},{id:"28",target:"科技"},{id:"29",target:"汽车"},{id:"30",target:"房产"},{id:"31",target:"生活"},{id:"32",target:"其他"},{id:"33",target:"NBAVIP"},{id:"100",target:"在线学习"},{id:"34",target:"NBAliveu"},{id:"35",target:"NBArealtime"},{id:"102",target:"2012欧洲杯"},{id:"101",target:"2012伦敦奥运会"},{id:"60",target:"母婴"},{id:"37",target:"微讲堂"},{id:"38",target:"MV2"},{id:"200",target:"mv1"},{id:"104",target:"热享"},{id:"105",target:"拍客"},{id:"106",target:"腾讯大讲堂"},{id:"39",target:"收费"},{id:"40",target:"广告"},{id:"41",target:"自拍"},{id:"42",target:"猎奇"},{id:"43",target:"搞笑"},{id:"46",target:"微电影"},{id:"44",target:"面包测试"},{id:"45",target:"儒释道"},{id:"47",target:"付费"},{id:"48",target:"storm测试"}],log:"",value:0},$(function(){var a=$('[data-form-item="type"]'),b=a.find("ul.dropdown-menu"),c=[];c.push('<li data-form-val="0"><a href="javascript:;">按分类</a></li>'),$.each(g_typemap.content,function(a,b){c.push('<li data-form-val="'+b.id+'"><a href="javascript:;">'+b.target+"</a></li>")}),b.html(c.join(""))}),window.ZLSH=window.ZLSH||{},ZLSH.dataquery=function(){function a(a,b){b=b||{},this.req=a,this.config={pager:{pagerContId:"",pageSize:10},flag:{needPager:!1},template:{modId:"",tplId:""}},$.extend(this.config,b)}return $.extend(a.prototype,{init:function(a){a=a||{},$.extend(this.config,a),this.initEvent(),this.queryPage(1)},initEvent:function(){var a=this;$("[data-form-item]").on("click","[data-form-val]",function(){var a=$(this),b=a.attr("data-form-val"),c=a.find("a").text(),d=a.parent().parent().find("[data-form-cond]");d.attr("data-form-cond",b),d.text(c)}),$('[data-form-button="submit"]').click(function(b){b.preventDefault();var c={};$("[data-form-item]").each(function(a,b){var d=$(b),e=d.attr("data-form-item"),f=d.find("[data-form-cond]").attr("data-form-cond");"undefined"!=typeof e&&"undefined"!=typeof f&&(c[e]=f)}),c.keyword=$('input[name="keyword"]').val(),c.offset=0,a.queryData(c)})},initPager:function(a){var b=this,c=a.total,d=b.req.getParam("offset"),e=b.config.pager.pageSize,f=Math.ceil(parseInt(d,10)/e)+1;$("#"+b.config.pager.pagerContId).pagination({items:c,itemsOnPage:b.config.pager.pageSize,currentPage:f,cssStyle:"pagination",prevText:"«",nextText:"»",onPageClick:function(a,c){c.preventDefault(),b.queryPage(a)}})},queryPage:function(a){var b=this;a=a||1;var c=(a-1)*b.config.pager.pageSize;b.queryData({offset:c})},queryData:function(a){var b=this;window.scrollTo(0,0);var c=this.req;c.setParam(a),c.query(function(a){b.doData(a)})},doData:function(a){var b=this;b.renderData(a),b.config.flag.needPager&&b.initPager(a)},renderData:function(a){var b=this;$("#video_total").text(a.total),txv.template.fillHtml(a,b.config.template.tplId,b.config.template.modId,!0,null,void 0,function(){})}}),a}(),window.ZLSH=window.ZLSH||{},ZLSH.main=function(a){function b(b){b=b||{},a.extend(l,b),txv.login.isLogin()&&(a.extend(Live.template.MODIFIERS,{getTypeName:function(a){if(a=a||"",a=""+a,!a||!window.g_typemap)return a;for(var b=0,c=g_typemap.content.length;c>b;b++){var d=g_typemap.content[b];if(a==d.id)return d.target}return a},formatDateStr:function(a){var b=new Date(a);return b.toLocaleString()},getReason:function(a){return a=a||0,a=""+a,i[a]}}),j=h(l.pageType,l.dataQueryParam),j.error=function(a){a&&(100010==a.returncode?txv.login.openLogin():200030==a.returncode&&ZLSH.util.message("当前登录用户不合法"))},j.check=function(a){return a&&0==a.returncode?!0:!1},k=new ZLSH.dataquery(j),k.init({pager:a.extend({},l.pageConfig.pager),flag:a.extend({},l.flag),template:a.extend({},l.template)}),ZLSH.player.init(),c())}function c(){a(document).on("click","[data-audit-submit]",function(b){b.preventDefault();var c=a(this),f=c.attr("data-audit-submit");"all"==f?d():e(f)})}function d(){var b=g();b.msg?ZLSH.util.message(b.msg):ZLSH.shenhe.shenhe({type:l.pageType,videoArr:b.videoArr,success:function(b){var c=[];b&&a.isArray(b.data)&&a.each(b.data,function(a,b){0!=b.ret&&c.push("("+b.vid+")提交失败")}),c.length>0?ZLSH.util.message(c.join("<hr>")):(ZLSH.util.message("提交成功"),k.queryPage(1))},error:function(a){ZLSH.util.message("提交失败:"+a)}})}function e(b){var c=g(b);c.msg?ZLSH.util.message(c.msg):ZLSH.shenhe.shenhe({type:l.pageType,videoArr:c.videoArr,success:function(b){var c=[],d=[];b&&a.isArray(b.data)&&a.each(b.data,function(a,b){0!=b.ret?c.push("("+b.vid+")提交失败"):d.push(b.vid)}),c.length>0?ZLSH.util.message(c.join("<hr>")):(ZLSH.util.message("重新提交成功"),f(d))},error:function(a){ZLSH.util.message("提交失败:"+a)}})}function f(b){for(var c=0,d=b.length;d>c;c++){var e=b[c],f=a("[data-audit-item="+e+"]"),g=f.find('input[name="'+e+'_result"]:checked'),h=g.val();if("undefined"==typeof h);else{var j=0,k="通过";"2"==h&&(j=g.attr("data-audit-reason"),k=i[j]);var l=f.find("[data-status-result]");l.attr("data-status-result",h),l.attr("data-status-reason",j),l.text(k)}}}function g(b){var c=[],d=[],e="[data-audit-item]";return b&&(e='[data-audit-item="'+b+'"]'),a(e).each(function(){var b=a(this),e=b.attr("data-audit-item"),f=b.find('input[name="'+e+'_result"]:checked'),g=f.val();if("undefined"==typeof g)d.push("("+e+")没有勾选通过状态");else{var h=0,i=b.find('input[name="'+e+'_remark"]').val();"2"==g&&(h=f.attr("data-audit-reason")),c.push({vid:e,result:parseInt(g,10),reason:parseInt(h,10),remark:i})}}),{videoArr:c,msg:d.join("<hr>")}}function h(a,b){return ZLSH.request.defaultInit(a,b)}var i={0:"0",1:"色情或反动",2:"境外网站",3:"低俗",4:"资料填写违规"},j=null,k=null,l={pageType:0,pageConfig:{pager:{pagerContId:"pager_cont",pageSize:10}},dataQueryParam:{otype:"json",offset:0,limit:10,audit_result:1},flag:{needPager:!1},template:{modId:"list_cont",tplId:"list_tpl"}};return{init:b}}(jQuery);
/*! zlsh 最后修改于： 2014-07-15 */