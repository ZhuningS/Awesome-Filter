<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="renderer" content="webkit">

    <title>项目详情</title>
    <!--[if lt IE 9]>
    <meta http-equiv="refresh" content="0;ie.html"/>
    <![endif]-->

    <link rel="shortcut icon" href="favicon.ico">
    <link href="../../assets/css/bootstrap.min.css?v=3.3.6" rel="stylesheet">
    <link href="../../assets/css/font-awesome.min.css?v=4.4.0" rel="stylesheet">
    <link href="../../assets/css/animate.css" rel="stylesheet">
    <link href="../../assets/css/plugins/bootstrap-table/bootstrap-table.min.css" rel="stylesheet">
    <link href="../../assets/css/style.css?v=4.1.0" rel="stylesheet">
    <style>

        .formTitle {
            width: 100px !important;
            font-size: 15px !important;
            color: #888 !important;
            border: 1px solid #ccc;
        }

        .formValue {
            width: 300px !important;
            border: 1px solid #ccc;
        }

        ul li {
            display: inline-block;
            float: left;
        }
    </style>
</head>
<body class="gray-bg top-navigation">
<div id="wrapper">
    <div id="page-wrapper" class="gray-bg">
        <div class="row border-bottom white-bg">
            <nav class="navbar navbar-static-top" role="navigation">
                <div class="navbar-header">
                    <button aria-controls="navbar" aria-expanded="false"
                            data-target="#navbar" data-toggle="collapse"
                            class="navbar-toggle collapsed" type="button">
                        <i class="fa fa-reorder"></i>
                    </button>
                    <a href="stAudit.html" class="navbar-brand">科委形式审核</a>
                </div>
                <div class="navbar-collapse " id="navbar">
                    <ul class="nav navbar-top-links navbar-right">
                        <li><a id="enterpriseDetail">
                            企业信息
                        </a></li>
                        <li><a id="projectdetail">
                            项目信息
                        </a></li>
                        <li><a id="persions">
                            项目参与人员
                        </a></li>
                        <li><a id="projectbudget">
                            项目开发预算
                        </a></li>
                        <li><a id="file">
                            附件
                        </a></li>
                        <!--<li><a id="contact">-->
                        <!--加计扣除联系人-->
                        <!--</a></li>-->
                    </ul>
                    <!--<ul class="nav navbar-top-links navbar-right">-->
                    <!--<li><a id="linkmanlist">-->
                    <!--加计扣除联系人-->
                    <!--</a></li>-->
                    <!--</ul>-->
                </div>
            </nav>
        </div>
        <div class="wrapper wrapper-content">
            <div class="container">
                <div class="row">
                    <div class="col-lg-10">
                        <div class="ibox float-e-margins">
                            <div class="ibox-title">
                                <h2>项目信息</h2>
                            </div>
                            <div class="ibox-content">
                                <table class="table">
                                    <tbody>
                                    <tr class="form-tr">
                                        <th class="formTitle">项目名称：</th>
                                        <td class="formValue">
                                            <label id="project" name="project"></label>
                                        </td>
                                    </tr>
                                    <tr class="form-tr">
                                        <th class="formTitle">项目所属技术领域：</th>
                                        <td class="formValue">
                                            <label id="technical" name="technical">
                                                <!--bittable="db_flow_jjkc_info" bitcol="TRTS" bitisrepeat=""-->
                                            </label>
                                            <div>
                                                <input type="checkbox" id="checkremark1"
                                                       style="width:18px;height:18px">
                                                <label style="color:red">建议修改</label>
                                                <input type="text" maxlength="1000" id="checkcontent1"
                                                       style="width:40%;" placeholder="最多可输入1000个字" hidden="hidden">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr class="form-tr">
                                        <th class="formTitle">项目研究背景与立项依据：</th>
                                        <td class="formValue">
                                            <label id="rbeb" name="rbeb"></label>
                                            <div>
                                                <input type="checkbox" id="checkremark2"
                                                       style="width:18px;height:18px">
                                                <label style="color:red">建议修改</label>
                                                <input type="text" maxlength="1000" id="checkcontent2"
                                                       style="width:40%;" placeholder="最多可输入1000个字" hidden="hidden">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr class="form-tr">
                                        <th class="formTitle">技术路线或技术方案：</th>
                                        <td class="formValue">
                                            <label id="trts" name="trts"></label>
                                            <div>
                                                <input type="checkbox" id="checkremark3"
                                                       style="width:18px;height:18px">
                                                <label style="color:red">建议修改</label>
                                                <input type="text" maxlength="1000" id="checkcontent3"
                                                       style="width:40%;" placeholder="最多可输入1000个字" hidden="hidden">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr class="form-tr">
                                        <th class="formTitle">核心创新点：</th>
                                        <td class="formValue">
                                            <label id="cip" name="cip"></label>
                                            <div>
                                                <input type="checkbox" id="checkremark4"
                                                       style="width:18px;height:18px">
                                                <label style="color:red">建议修改</label>
                                                <input type="text" maxlength="1000" id="checkcontent4"
                                                       style="width:40%;" placeholder="最多可输入1000个字" hidden="hidden">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr class="form-tr">
                                        <th class="formTitle">项目工作基础与研发条件：</th>
                                        <td class="formValue">
                                            <label id="wbrdc" name="wbrdc"></label>
                                            <div>
                                                <input type="checkbox" id="checkremark5"
                                                       style="width:18px;height:18px">
                                                <label style="color:red">建议修改</label>
                                                <input type="text" maxlength="1000" id="checkcontent5"
                                                       style="width:40%;" placeholder="最多可输入1000个字" hidden="hidden">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr class="form-tr">
                                        <th class="formTitle">项目进度安排：</th>
                                        <td class="formValue">
                                            <label id="schedule" name="schedule"></label>s
                                            <div>
                                                <input type="checkbox" id="checkremark6"
                                                       style="width:18px;height:18px">
                                                <label style="color:red">建议修改</label>
                                                <input type="text" maxlength="1000" id="checkcontent6"
                                                       style="width:40%;" placeholder="最多可输入1000个字" hidden="hidden">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr class="form-tr">
                                        <th class="formTitle">项目考核指标：</th>
                                        <td class="formValue">
                                            <label id="ai" name="ai"></label>
                                            <div>
                                                <input type="checkbox" id="checkremark7"
                                                       style="width:18px;height:18px">
                                                <label style="color:red">建议修改</label>
                                                <input type="text" maxlength="1000" id="checkcontent7"
                                                       style="width:40%;" placeholder="最多可输入1000个字" hidden="hidden">
                                            </div>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--审核结果-->

            <div class="container">
                <div class="ibox float-e-margins col-lg-10">
                    <!--<div class="ibox-title">-->
                    <!--<h5>科委形式审核意见</h5>-->
                    <!--</div>-->
                    <div class="ibox-content">

                        <table class="table">
                            <tbody>
                            <tr>
                                <th class="formTitle">审核状态：</th>
                                <td class="formValue">
                                    <label>
                                        <button id="button" class="btn btn-sm btn-primary">收集修改提示数据</button>
                                    </label>
                                </td>
                            </tr>
                            <!--<tr>-->
                            <!--<th class="formTitle">科委形式审核意见：</th>-->
                            <!--<td class="formValue">-->
                            <!--<label id="opinion"></label>-->
                            <!--</td>-->
                            <!--</tr>-->
                            <!--<tr>-->
                            <!--<th class="formTitle">是否通过</th>-->
                            <!--<td>-->

                            <!--&lt;!&ndash;<div class="col-sm-8">&ndash;&gt;-->
                            <!--&lt;!&ndash;</div>&ndash;&gt;-->
                            <!--<input type="radio" name="auditresult" id="auditresult1" value="12" class="radio-inline" checked>通过-->
                            <!--<input type="radio" name="auditresult" id="auditresult2" value="10"   class="radio-inline">不通过-->

                            <!--</td>-->
                            <!--</tr>-->
                            <tr id="auditopinionId">
                                <th class="formTitle">科委形式审核意见</th>
                                <!--<th class="formTitle">追加修改意见</th>-->
                                <!--<label for="updateOption" class="col-sm-3 control-label">追加修改意见</label>-->
                                <td class="formValue"><textarea class="form-control" rows="4" id="updateOption"
                                                                placeholder="人工审核意见" aria-required="true"
                                                                required></textarea></td>
                            </tr>
                            <!--<tr >-->
                            <!--<td align="center" colspan="2"><button id="btn1" class="btn btn-sm btn-primary">提交审核意见</button></td>-->
                            <!--</tr>-->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 全局js -->
<script src="../../assets/js/jquery.min.js?v=2.1.4"></script>
<script src="../../assets/js/bootstrap.min.js?v=3.3.6"></script>

<!-- 自定义js -->
<script src="../../assets/js/content.js?v=1.0.0"></script>


<!-- Bootstrap table -->
<script src="../../assets/js/plugins/bootstrap-table/bootstrap-table.min.js"></script>
<script src="../../assets/js/plugins/bootstrap-table/bootstrap-table-mobile.min.js"></script>
<script src="../../assets/js/plugins/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script>
<script src="../../assets/js/myjs.js"></script>

<!-- Peity -->
<script src="../../assets/js/demo/bootstrap-table-demo.js"></script>
</body>
<script type="text/javascript">
    $("#back").click(function () {
        window.history.go(-1);
    })


    $("document").ready(function () {
        init()
    })
    function init() {
        var url = window.location.search;
        var str = url.substr(1);
        var strs = str.split("=");

        $.ajax({
            type: 'post',
            dataType: 'json',
            url: baseUrl + '/stAudit/getProjectdetail.do',
            data: {'sn': strs[1]},
            success: function (data) {
                if (data.status == 0) {
//                    $("#realname").text(data.data.realname);

                    for (var p in data.data) {
//                        console.info(p)
                        $("#" + p + "").text(data.data[p]);
//                        $("#enterpriseTable").find(":label[name='" + p + "']").text(data.data[p]);
                    }
                }
            },
            error: function (data) {
                console.info(data)
            }
        })

        $.ajax({
            type: 'post',
            dataType: 'json',
            data: {'sn': strs[1]},
            url: baseUrl + '/stAudit/getOpinion.do',
            success: function (data) {
                console.info(data.data)
                if (data.status == 0) {
                    $("#updateOption").val(data.data)
                }
            }
        })
    }


    $("#checkremark1").click(function () {
        if (this.checked) {
            $("#checkcontent1").removeAttr("hidden");
        } else {
            $("#checkcontent1").attr("hidden", "hidden");
        }
    })
    $("#checkremark2").click(function () {
        if (this.checked) {
            $("#checkcontent2").removeAttr("hidden");
        } else {
            $("#checkcontent2").attr("hidden", "hidden");
        }
    })
    $("#checkremark3").click(function () {
        if (this.checked) {
            $("#checkcontent3").removeAttr("hidden");
        } else {
            $("#checkcontent3").attr("hidden", "hidden");
        }
    })
    $("#checkremark4").click(function () {
        if (this.checked) {
            $("#checkcontent4").removeAttr("hidden");
        } else {
            $("#checkcontent4").attr("hidden", "hidden");
        }
    })
    $("#checkremark5").click(function () {
        if (this.checked) {
            $("#checkcontent5").removeAttr("hidden");
        } else {
            $("#checkcontent5").attr("hidden", "hidden");
        }
    })
    $("#checkremark6").click(function () {
        if (this.checked) {
            $("#checkcontent6").removeAttr("hidden");
        } else {
            $("#checkcontent6").attr("hidden", "hidden");
        }
    })
    $("#checkremark7").click(function () {
        if (this.checked) {
            $("#checkcontent7").removeAttr("hidden");
        } else {
            $("#checkcontent7").attr("hidden", "hidden");
        }
    })

    $("#button").click(function () {
        var projectContext = ''
        console.info("+++++++++______++++++++++" + $("#opinion").val())
        var temp = $("#checkcontent1").val();
        if (temp.length > 2) {
            projectContext = projectContext + "【项目所属技术领域】:" + temp + ";"
        }
        temp = $("#checkcontent2").val();
        if (temp.length > 2) {
            projectContext = projectContext + "【项目研究背景与立项依据】:" + temp + ";"
        }
        temp = $("#checkcontent3").val();
        if (temp.length > 2) {
            projectContext = projectContext + "【技术路线或技术方案】:" + temp + ";"
        }
        temp = $("#checkcontent4").val();
        if (temp.length > 2) {
            projectContext = projectContext + "【核心创新点】:" + temp + ";"
        }
        temp = $("#checkcontent5").val();
        if (temp.length > 2) {
            projectContext = projectContext + "【项目工作基础与研发条件】:" + temp + ";"
        }
        temp = $("#checkcontent6").val();
        if (temp.length > 2) {
            projectContext = projectContext + "【项目进度安排】:" + temp + ";"
        }
        temp = $("#checkcontent7").val();
        if (temp.length > 2) {
            projectContext = projectContext + "【项目考核指标】:" + temp + ";"
        }

        var opinion = $("#updateOption").val();
        $("#updateOption").val(opinion + projectContext);
        btn1();

        for (var i=1; i<=7;i++) {
            $("#checkcontent"+i+"").val("");
        }
    })


    $("#auditresult1").click(function () {
        $("#auditopinionId").attr("hidden", "hidden");
    })
    $("#auditresult2").click(function () {
        $("#auditopinionId").removeAttr("hidden");
    })


    //    $("#btn1").click(function () {
    function btn1() {
        var auditresult1 = $("#auditresult1").val()

        var option = $("#updateOption").val();

        if ($('#auditresult2').is(':checked')) {
            auditresult1 = $("#auditresult2").val()
            if (option == "") {
                alert("审核意见不能为空")
                return false;
            }
        }
        var url = window.location.search;
        var str = url.substr(1);
        var strs = str.split("=");
        $.ajax({
            type: 'post',
            data: {"opinion": option, "sn": strs[1], "status": auditresult1},
            dataType: 'json',
            url: baseUrl + '/stAudit/updateOpinion.do',
            success: function (data) {
                if (data.status == 0) {
//                    alert("增加人工审核意见成功")
//                    window.location.href=baseUrl+"/page/stAudit/stAudit.html"
//                    init()
                }
            },
            error: function (data) {
                console.info(data)
            }
        })
    }


</script>
</html>